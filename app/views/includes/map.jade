div(id='map')
script.
    window.onload = function () {
        var baseLayer = L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
                maxZoom: 10
            }
        );
        //var heatmapLayer = new HeatmapOverlay(!{JSON.stringify(map.heatmapConfig)});
        var map = new L.Map('map', {
            //center: new L.LatLng(!{map.config.center[0]}, !{map.config.center[1]}),
            //zoom: !{map.config.zoom},
            layers: [baseLayer],
            scrollWheelZoom: !{map.config.scrollWheelZoom}
        });

        if (!{map.hasMarker}) {
            L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            L.marker([!{map.marker.coords}]).addTo(map)
                .bindPopup('!{map.marker.text}')
                .openPopup();
        }

        L.control.scale().addTo(map);

        var coverageLayer = new L.TileLayer.MaskCanvas(!{JSON.stringify(map.maskConfig)});
        coverageLayer.setData(!{JSON.stringify(map.heatmapData.data)});
        map.fitBounds(coverageLayer.bounds);
        map.addLayer(coverageLayer);
    };